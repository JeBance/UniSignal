# üöÄ UniSignal Relay

**–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —à–ª—é–∑ –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –∏–∑ Telegram**

UniSignal Relay –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ [Telegrab](https://github.com/JeBance/telegrab), –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö Telegram-–∫–∞–Ω–∞–ª–æ–≤, –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏—Ö –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º —á–µ—Ä–µ–∑ WebSocket.

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [‚ö° –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –æ–¥–∏–Ω –∫–ª–∏–∫](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–≤-–æ–¥–∏–Ω-–∫–ª–∏–∫-docker)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [Admin API](#-admin-api)
- [WebSocket API](#-websocket-api)
- [–ü–∞—Ä—Å–µ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤](#-–ø–∞—Ä—Å–µ—Ä-—Å–∏–≥–Ω–∞–ª–æ–≤)
- [–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞](#-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîå **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Telegrab** ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ WebSocket-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –∞–≤—Ç–æ-–ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
- üì° **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–∞–Ω–∞–ª–æ–≤** ‚Äî –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö Telegram-–∫–∞–Ω–∞–ª–æ–≤ –≤ –ë–î
- üß† **–£–º–Ω—ã–π –ø–∞—Ä—Å–µ—Ä** ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∏–∫–µ—Ä–∞, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (LONG/SHORT), —Ü–µ–Ω –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞
- üíæ **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è** ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø—Ä–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
- üîê **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî API-–∫–ª—é—á–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ WebSocket
- üìä **Admin HTTP API** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏, –∫–∞–Ω–∞–ª–∞–º–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üîÑ **–ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ë–î
- üìù **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ Pino

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      WebSocket       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Telegrab  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ ‚îÇ  UniSignal Relay ‚îÇ
‚îÇ  (Upstream) ‚îÇ    ws://194.87...    ‚îÇ   (Port 8080)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                              ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                         ‚îÇ                         ‚îÇ
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ   Admin   ‚îÇ           ‚îÇ   Client    ‚îÇ           ‚îÇ  PostgreSQL ‚îÇ
              ‚îÇ HTTP API  ‚îÇ           ‚îÇ  WebSocket  ‚îÇ           ‚îÇ   Database  ‚îÇ
              ‚îÇ /admin/*  ‚îÇ           ‚îÇ    /ws      ‚îÇ           ‚îÇ  (messages, ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ   channels, ‚îÇ
                                                                ‚îÇ   clients)  ‚îÇ
                                                                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

1. **Telegrab** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ `new_message` ‚Üí
2. **UniSignal** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–Ω–∞–ª –≤ –±–µ–ª–æ–º —Å–ø–∏—Å–∫–µ ‚Üí
3. **–ü–∞—Ä—Å–µ—Ä** –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (—Ç–∏–∫–µ—Ä, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, —Ü–µ–Ω—ã) ‚Üí
4. **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è** –ø–æ `unique_hash` ‚Üí
5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** –≤ PostgreSQL ‚Üí
6. **–¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è** –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º —á–µ—Ä–µ–∑ WebSocket

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose
- Node.js 18+ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

---

## ‚ö° –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –æ–¥–∏–Ω –∫–ª–∏–∫ (Docker)

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/JeBance/UniSignal.git && cd UniSignal

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env: —É–∫–∞–∑–∞—Ç—å TELEGRAB_API_KEY –∏ TELEGRAB_WS_URL

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å
docker compose up -d

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
curl http://localhost:8080/health
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.

---

## üìù –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/JeBance/UniSignal.git
cd UniSignal
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:

```bash
# App
PORT=8080
LOG_LEVEL=info
ADMIN_MASTER_KEY=super_secret_admin_key_change_me

# Telegrab
# –ï—Å–ª–∏ Telegrab –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ: ws://host.docker.internal:3000/ws
# –ï—Å–ª–∏ Telegrab –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ: ws://<ip>:3000/ws
TELEGRAB_WS_URL=ws://host.docker.internal:3000/ws
TELEGRAB_API_KEY=<your_telegrab_api_key>

# Database
DATABASE_URL=postgresql://unisignal:unisignal_password@db:5432/unisignal
```

### 3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
docker compose up -d
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ.

–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:

```bash
docker compose logs -f app
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
curl http://localhost:8080/health
```

–û—Ç–≤–µ—Ç:

```json
{
  "status": "ok",
  "service": "UniSignal Relay",
  "timestamp": "2026-02-26T12:00:00.000Z",
  "checks": {
    "database": "ok"
  }
}
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|-------------|----------|--------------|
| `PORT` | –ù–µ—Ç | –ü–æ—Ä—Ç –¥–ª—è HTTP –∏ WebSocket | `8080` |
| `LOG_LEVEL` | –ù–µ—Ç | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | `info` |
| `ADMIN_MASTER_KEY` | **–î–∞** | –ú–∞—Å—Ç–µ—Ä-–∫–ª—é—á –¥–ª—è Admin API | ‚Äî |
| `TELEGRAB_WS_URL` | **–î–∞** | URL WebSocket Telegrab | ‚Äî |
| `TELEGRAB_API_KEY` | **–î–∞** | API-–∫–ª—é—á –¥–ª—è Telegrab | ‚Äî |
| `DATABASE_URL` | **–î–∞** | Connection string PostgreSQL | ‚Äî |

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –¥–ª—è Docker:** –ï—Å–ª–∏ Telegrab –∑–∞–ø—É—â–µ–Ω –Ω–∞ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ws://host.docker.internal:3000/ws`. –ù–∞ Linux –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ–±–∞–≤–∏—Ç—å `--add-host=host.docker.internal:host-gateway` –∫ docker-compose.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–æ–≤

–§–∞–π–ª `config/parsers.yaml` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π:

```yaml
channels:
  default:
    direction:
      long: ["‚¨ÜÔ∏è", "üü¢", "üöÄ", "Long", "BUY"]
      short: ["‚¨áÔ∏è", "üî¥", "üìâ", "Short", "SELL"]
    ticker:
      pattern: "/\\b([A-Z]{3,6})(USDT|BTC|ETH)\\b/"
      group: 1
    entry:
      pattern: "/(?:Entry|–í—Ö–æ–¥)[:\\s]*([0-9.,]+)/i"
      group: 1
    stop_loss:
      pattern: "/(?:SL|Stop)[:\\s]*([0-9.,]+)/i"
      group: 1
    take_profit:
      pattern: "/(?:TP|Target)[:\\s]*([0-9.,]+)/i"
      group: 1
```

---

## üîß Admin API

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Admin-Key` —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º `ADMIN_MASTER_KEY`.

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏

#### POST /admin/clients

–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞:

```bash
curl -X POST http://localhost:8080/admin/clients \
  -H "X-Admin-Key: $ADMIN_MASTER_KEY"
```

–û—Ç–≤–µ—Ç:

```json
{
  "id": "uuid-...",
  "api_key": "usk_abc123...",
  "is_active": true,
  "created_at": "2026-02-26T12:00:00.000Z"
}
```

#### GET /admin/clients

–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤:

```bash
curl http://localhost:8080/admin/clients \
  -H "X-Admin-Key: $ADMIN_MASTER_KEY"
```

#### DELETE /admin/clients/:id

–û—Ç–æ–∑–≤–∞—Ç—å –∫–ª—é—á –∫–ª–∏–µ–Ω—Ç–∞:

```bash
curl -X DELETE http://localhost:8080/admin/clients/<client-id> \
  -H "X-Admin-Key: $ADMIN_MASTER_KEY"
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞–º–∏

#### POST /admin/channels

–î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª –≤ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫:

```bash
curl -X POST http://localhost:8080/admin/channels \
  -H "X-Admin-Key: $ADMIN_MASTER_KEY" \
  -H "Content-Type: application/json" \
  -d '{"chat_id": 5610580916, "name": "JeBance", "is_active": true}'
```

#### GET /admin/channels

–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤:

```bash
curl http://localhost:8080/admin/channels \
  -H "X-Admin-Key: $ADMIN_MASTER_KEY"
```

–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–∞–Ω–∞–ª—ã (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ):

```bash
curl "http://localhost:8080/admin/channels?all=true" \
  -H "X-Admin-Key: $ADMIN_MASTER_KEY"
```

#### DELETE /admin/channels/:chatId

–£–±—Ä–∞—Ç—å –∫–∞–Ω–∞–ª –∏–∑ —Ñ–∏–ª—å—Ç—Ä–∞:

```bash
curl -X DELETE http://localhost:8080/admin/channels/5610580916 \
  -H "X-Admin-Key: $ADMIN_MASTER_KEY"
```

#### PATCH /admin/channels/:chatId/toggle

–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∫–∞–Ω–∞–ª:

```bash
curl -X PATCH http://localhost:8080/admin/channels/5610580916/toggle \
  -H "X-Admin-Key: $ADMIN_MASTER_KEY" \
  -H "Content-Type: application/json" \
  -d '{"is_active": false}'
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

#### GET /admin/stats

```bash
curl http://localhost:8080/admin/stats \
  -H "X-Admin-Key: $ADMIN_MASTER_KEY"
```

–û—Ç–≤–µ—Ç:

```json
{
  "messages": {
    "total": 150,
    "today": 25,
    "with_ticker": 120,
    "long_count": 80,
    "short_count": 40
  },
  "channels": {
    "active": 3
  },
  "clients": {
    "total": 5,
    "active": 4
  }
}
```

---

## üîó WebSocket API

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```
ws://localhost:8080/ws
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç **–æ–±—è–∑–∞–Ω** –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–µ—á–µ–Ω–∏–µ 5 —Å–µ–∫—É–Ω–¥:

```json
{
  "action": "auth",
  "api_key": "usk_abc123..."
}
```

#### –£—Å–ø–µ—à–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```json
{
  "status": "authenticated",
  "message": "Welcome to UniSignal Relay"
}
```

#### –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

```json
{
  "status": "error",
  "message": "Invalid API Key"
}
```

–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –∫–æ–¥–æ–º `4002`.

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤

–ü–æ—Å–ª–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```json
{
  "type": "signal",
  "data": {
    "id": 105,
    "channel": "JeBance",
    "direction": "LONG",
    "ticker": "BTCUSDT",
    "entryPrice": 45000,
    "stopLoss": 44000,
    "takeProfit": 47000,
    "text": "üü¢ LONG BTCUSDT\nEntry: 45000\nSL: 44000\nTP: 47000",
    "timestamp": 1740569076
  }
}
```

### –ü—Ä–∏–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ JavaScript

```javascript
const ws = new WebSocket('ws://localhost:8080/ws');

ws.on('open', () => {
  console.log('Connected, authenticating...');
  ws.send(JSON.stringify({
    action: 'auth',
    api_key: 'usk_abc123...'
  }));
});

ws.on('message', (data) => {
  const message = JSON.parse(data.toString());
  
  if (message.status === 'authenticated') {
    console.log('‚úÖ Authenticated:', message.message);
  } else if (message.type === 'signal') {
    console.log('üì° New signal:', message.data);
  }
});

ws.on('close', (code, reason) => {
  console.log(`Disconnected: code=${code}, reason=${reason}`);
});

ws.on('error', (err) => {
  console.error('WebSocket error:', err);
});
```

---

## üß† –ü–∞—Ä—Å–µ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤

–ü–∞—Ä—Å–µ—Ä –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è:

### –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (direction)

| –¢–∏–ø | –ú–∞—Ä–∫–µ—Ä—ã |
|-----|---------|
| **LONG** | ‚¨ÜÔ∏è üü¢ üöÄ Long LONG Buy BUY –õ–æ–Ω–≥ –õ–û–ù–ì –ü–æ–∫—É–ø–∫–∞ |
| **SHORT** | ‚¨áÔ∏è üî¥ üìâ Short SHORT Sell SELL –®–æ—Ä—Ç –®–û–†–¢ –ü—Ä–æ–¥–∞–∂–∞ |

### –¢–∏–∫–µ—Ä (ticker)

–ü–∞—Ç—Ç–µ—Ä–Ω: `[A-Z]{3,6}(USDT|BTC|ETH|USD|BUSD)`

–ü—Ä–∏–º–µ—Ä—ã: `BTCUSDT`, `ETHUSDT`, `ALTBTC`

### –¶–µ–Ω—ã

| –ü–æ–ª–µ | –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ |
|------|----------------|
| **entry_price** | Entry, –í—Ö–æ–¥, Enter, Open |
| **stop_loss** | Stop Loss, Stop, SL, –°—Ç–æ–ø, –°–õ |
| **take_profit** | Take Profit, TP, Target, –¢–µ–π–∫, –¢–ü, –¶–µ–ª—å |

### –ü—Ä–∏–º–µ—Ä—ã –ø–∞—Ä—Å–∏–Ω–≥–∞

| –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-----------------|-----------|
| `üü¢ LONG BTCUSDT Entry: 45000 SL: 44000 TP: 47000` | `direction: LONG, ticker: BTC, entry: 45000, sl: 44000, tp: 47000` |
| `üî¥ SHORT ETHUSDT –í—Ö–æ–¥: 2000 –°—Ç–æ–ø: 2100 –¢–µ–π–∫: 1800` | `direction: SHORT, ticker: ETH, entry: 2000, sl: 2100, tp: 1800` |
| `–ü—Ä–æ—Å—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–µ–∑ —Å–∏–≥–Ω–∞–ª–∞` | `direction: null, ticker: null, prices: null` |

---

## üõ† –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å Docker

–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å hot reload –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose.override.yml`:

```bash
cp docker-compose.override.example docker-compose.override.yml
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ TELEGRAB_API_KEY –≤ docker-compose.override.yml
docker compose -f docker-compose.yml -f docker-compose.override.yml up -d
```

–≠—Ç–æ –≤–∫–ª—é—á–∏—Ç:
- Hot reload (tsx watch)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è debug
- Volume –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (hot reload)
npm run dev

# –°–±–æ—Ä–∫–∞ TypeScript
npm run build

# –ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–Ω-–≤–µ—Ä—Å–∏–∏
npm start
```

### –¢–µ—Å—Ç—ã

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
npm test

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ watch
npm run test:watch
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
npm run db:migrate:up

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
npm run db:migrate:down

# –ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
npm run db:migrate:redo

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
npm run db:migrate create my_migration
```

### –õ–∏–Ω—Ç–∏–Ω–≥

```bash
npm run lint
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
UniSignal/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ index.ts                    # Entry point
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ parsers.yaml            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ connection.ts           # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 001_initial_schema.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ db.config.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ channel-repository.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ client-repository.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ message-repository.ts
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin-api.ts            # HTTP Admin API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ buffer.ts               # In-memory –±—É—Ñ–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client-ws.ts            # Downstream WebSocket
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ message-processor.ts    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parser.ts               # –ü–∞—Ä—Å–µ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ telegrab-ws.ts          # Upstream Telegrab WS
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îî‚îÄ‚îÄ logger.ts               # Pino –ª–æ–≥–≥–µ—Ä
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ admin-api.test.ts
‚îÇ   ‚îú‚îÄ‚îÄ client-ws.test.ts
‚îÇ   ‚îî‚îÄ‚îÄ parser.test.ts
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ parsers.yaml
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ migrate.sh
‚îÇ   ‚îî‚îÄ‚îÄ migrate.cmd
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îî‚îÄ‚îÄ README.md
```

---

## üìä –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

- ‚úÖ `docker-compose up -d` –ø–æ–¥–Ω–∏–º–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –∏ –¥–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª —á–µ—Ä–µ–∑ HTTP API
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram ‚Üí –ø–æ—è–≤–ª—è–µ—Ç—Å—è —É –∫–ª–∏–µ–Ω—Ç–∞ WS < 1 —Å–µ–∫
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∫–∞–Ω–∞–ª–æ–≤ –Ω–µ –∏–∑ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –¥—É–±–ª–µ–π –≤ –ë–î
- ‚úÖ –ö–ª–∏–µ–Ω—Ç –±–µ–∑ –∫–ª—é—á–∞ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- ‚úÖ Admin API –±–µ–∑ –∫–ª—é—á–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

## üë§ –ê–≤—Ç–æ—Ä

JeBance

[GitHub](https://github.com/JeBance/UniSignal)
